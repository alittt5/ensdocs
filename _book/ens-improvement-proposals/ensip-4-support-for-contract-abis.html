
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>ENSIP-4: Support for contract ABIs Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="A mechanism for storing ABI definitions in ENS, for easy lookup of contract interfaces by callers (formerly EIP-205).">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="ensip-5-text-records.html" />
    
    
    <link rel="prev" href="ensip-3-reverse-resolution.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../terminology.html">
            
                <a href="../terminology.html">
            
                    
                    Terminology
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../frequently-asked-questions.html">
            
                <a href="../frequently-asked-questions.html">
            
                    
                    Frequently Asked Questions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../ens-deployments.html">
            
                <a href="../ens-deployments.html">
            
                    
                    ENS Deployments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../permanent-registrar-faq.html">
            
                <a href="../permanent-registrar-faq.html">
            
                    
                    Registrar Frequently Asked Questions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../deploying-ens-on-a-private-chain.html">
            
                <a href="../deploying-ens-on-a-private-chain.html">
            
                    
                    Deploying ENS on a Private Chain
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../dns-registrar-guide.html">
            
                <a href="../dns-registrar-guide.html">
            
                    
                    DNS Registrar guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../bug-bounty-program.html">
            
                <a href="../bug-bounty-program.html">
            
                    
                    Bug Bounty Program
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="./">
            
                <a href="./">
            
                    
                    ENS Improvement Proposals
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="ensip-1-ens.html">
            
                <a href="ensip-1-ens.html">
            
                    
                    ENSIP-1: ENS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="ensip-2-initial-hash-registrar.html">
            
                <a href="ensip-2-initial-hash-registrar.html">
            
                    
                    ENSIP-2: Initial Hash Registrar
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="ensip-3-reverse-resolution.html">
            
                <a href="ensip-3-reverse-resolution.html">
            
                    
                    ENSIP-3: Reverse Resolution
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.9.4" data-path="ensip-4-support-for-contract-abis.html">
            
                <a href="ensip-4-support-for-contract-abis.html">
            
                    
                    ENSIP-4: Support for contract ABIs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="ensip-5-text-records.html">
            
                <a href="ensip-5-text-records.html">
            
                    
                    ENSIP-5: Text Records
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="ensip-6-dns-in-ens.html">
            
                <a href="ensip-6-dns-in-ens.html">
            
                    
                    ENSIP-6: DNS-in-ENS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="ensip-7-contenthash-field.html">
            
                <a href="ensip-7-contenthash-field.html">
            
                    
                    ENSIP-7: Contenthash field
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.8" data-path="ensip-8-interface-discovery.html">
            
                <a href="ensip-8-interface-discovery.html">
            
                    
                    ENSIP-8: Interface Discovery
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.9" data-path="ensip-9-multichain-address-resolution.html">
            
                <a href="ensip-9-multichain-address-resolution.html">
            
                    
                    ENSIP-9: Multichain Address Resolution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.10" data-path="ensip-10-wildcard-resolution.html">
            
                <a href="ensip-10-wildcard-resolution.html">
            
                    
                    ENSIP-10: Wildcard Resolution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.11" data-path="ensip-11-evmchain-address-resolution.html">
            
                <a href="ensip-11-evmchain-address-resolution.html">
            
                    
                    ENSIP-11: EVM compatible Chain Address Resolution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.12" data-path="ensip-12-avatar-text-records.html">
            
                <a href="ensip-12-avatar-text-records.html">
            
                    
                    ENSIP-12: Avatar Text Records
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Dapp Developer Guide</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../dapp-developer-guide/ens-enabling-your-dapp.html">
            
                <a href="../dapp-developer-guide/ens-enabling-your-dapp.html">
            
                    
                    ENS Enabling your DApp
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../dapp-developer-guide/ens-libraries.html">
            
                <a href="../dapp-developer-guide/ens-libraries.html">
            
                    
                    ENS Libraries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../dapp-developer-guide/working-with-ens.html">
            
                <a href="../dapp-developer-guide/working-with-ens.html">
            
                    
                    Working with ENS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../dapp-developer-guide/resolving-names.html">
            
                <a href="../dapp-developer-guide/resolving-names.html">
            
                    
                    Resolving Names
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../dapp-developer-guide/managing-names.html">
            
                <a href="../dapp-developer-guide/managing-names.html">
            
                    
                    Managing Names
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../dapp-developer-guide/registering-and-renewing-names.html">
            
                <a href="../dapp-developer-guide/registering-and-renewing-names.html">
            
                    
                    Registering & Renewing Names
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="../dapp-developer-guide/front-end-design-guidelines.html">
            
                <a href="../dapp-developer-guide/front-end-design-guidelines.html">
            
                    
                    ENS Front-End Design Guidelines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="../dapp-developer-guide/ens-as-nft.html">
            
                <a href="../dapp-developer-guide/ens-as-nft.html">
            
                    
                    ENS as NFT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="../dapp-developer-guide/ens-l2-offchain.html">
            
                <a href="../dapp-developer-guide/ens-l2-offchain.html">
            
                    
                    ENS Layer2 and offchain data support
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Contract API Reference</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../contract-api-reference/name-processing.html">
            
                <a href="../contract-api-reference/name-processing.html">
            
                    
                    Name Processing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../contract-api-reference/ens.html">
            
                <a href="../contract-api-reference/ens.html">
            
                    
                    Registry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../contract-api-reference/reverseregistrar.html">
            
                <a href="../contract-api-reference/reverseregistrar.html">
            
                    
                    ReverseRegistrar
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../contract-api-reference/testregistrar.html">
            
                <a href="../contract-api-reference/testregistrar.html">
            
                    
                    TestRegistrar
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="../contract-api-reference/publicresolver.html">
            
                <a href="../contract-api-reference/publicresolver.html">
            
                    
                    PublicResolver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="../contract-api-reference/.eth-permanent-registrar/">
            
                <a href="../contract-api-reference/.eth-permanent-registrar/">
            
                    
                    .eth Permanent Registrar
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.6.1" data-path="../contract-api-reference/.eth-permanent-registrar/registrar.html">
            
                <a href="../contract-api-reference/.eth-permanent-registrar/registrar.html">
            
                    
                    Registrar
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6.2" data-path="../contract-api-reference/.eth-permanent-registrar/controller.html">
            
                <a href="../contract-api-reference/.eth-permanent-registrar/controller.html">
            
                    
                    Controller
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="../contract-api-reference/dns-registrar.html">
            
                <a href="../contract-api-reference/dns-registrar.html">
            
                    
                    DNS Registrar
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Contract Developer Guide</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../contract-developer-guide/resolving-names-on-chain.html">
            
                <a href="../contract-developer-guide/resolving-names-on-chain.html">
            
                    
                    Resolving Names On-chain
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../contract-developer-guide/writing-a-resolver.html">
            
                <a href="../contract-developer-guide/writing-a-resolver.html">
            
                    
                    Writing a Resolver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../contract-developer-guide/writing-a-registrar.html">
            
                <a href="../contract-developer-guide/writing-a-registrar.html">
            
                    
                    Writing a Registrar
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" >
            
                <a target="_blank" href="https://discuss.ens.domains">
            
                    
                    ENS Discussion Forum
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" >
            
                <a target="_blank" href="https://discord.gg/AskZbFx">
            
                    
                    ENS Support Chat
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">ENS Migration (February 2020)</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../ens-migration-february-2020/guide-for-dapp-developers.html">
            
                <a href="../ens-migration-february-2020/guide-for-dapp-developers.html">
            
                    
                    Guide for DApp Developers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../ens-migration-february-2020/technical-description.html">
            
                <a href="../ens-migration-february-2020/technical-description.html">
            
                    
                    Technical Description
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >ENSIP-4: Support for contract ABIs</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="ensip-4-support-for-contract-abis">ENSIP-4: Support for contract ABIs</h1>
<table>
<thead>
<tr>
<th><strong>Author</strong></th>
<th>Nick Johnson \<a href="mailto:nick@ens.domains" target="_blank">nick@ens.domains</a></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Status</strong></td>
<td>Final</td>
</tr>
<tr>
<td><strong>Submitted</strong></td>
<td>2017-02-06</td>
</tr>
</tbody>
</table>
<h3 id="abstract">Abstract</h3>
<p>ABIs are important metadata required for interacting with most contracts. At present, they are typically supplied out-of-band, which adds an additional burden to interacting with contracts, particularly on a one-off basis or where the ABI may be updated over time. The small size of ABIs permits an alternative solution, storing them in ENS, permitting name lookup and ABI discovery via the same process.</p>
<p>ABIs are typically quite compact; the largest in-use ABI we could find, that for the DAO, is 9450 bytes uncompressed JSON, 6920 bytes uncompressed CBOR, and 1128 bytes when the JSON form is compressed with zlib. Further gains on CBOR encoding are possible using a CBOR extension that permits eliminating repeated strings, which feature extensively in ABIs. Most ABIs, however, are far shorter than this, consisting of only a few hundred bytes of uncompressed JSON.</p>
<p>This ENSIP defines a resolver profile for retrieving contract ABIs, as well as encoding standards for storing ABIs for different applications, allowing the user to select between different representations based on their need for compactness and other considerations such as onchain access.</p>
<h3 id="specification">Specification</h3>
<h4 id="abi-encodings">ABI encodings</h4>
<p>In order to allow for different tradeoffs between onchain size and accessibility, several ABI encodings are defined. Each ABI encoding is defined by a unique constant with only a single bit set, allowing for the specification of 256 unique encodings in a single uint.</p>
<p>The currently recognised encodings are:</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>JSON</td>
</tr>
<tr>
<td>2</td>
<td>zlib-compressed JSON</td>
</tr>
<tr>
<td>4</td>
<td>CBOR</td>
</tr>
<tr>
<td>8</td>
<td>URI</td>
</tr>
</tbody>
</table>
<p>This table may be extended in future through the ENSIP process.</p>
<p>Encoding type 1 specifies plaintext JSON, uncompressed; this is the standard format in which ABIs are typically encoded, but also the bulkiest, and is not easily parseable onchain.</p>
<p>Encoding type 2 specifies zlib-compressed JSON. This is significantly smaller than uncompressed JSON, and is straightforward to decode offchain. However, it is impractical for onchain consumers to use.</p>
<p>Encoding type 4 is <a href="https://cbor.io" target="_blank">CBOR</a>. CBOR is a binary encoding format that is a superset of JSON, and is both more compact and easier to parse in limited environments such as the EVM. Consumers that support CBOR are strongly encouraged to also support the <a href="http://cbor.schmorp.de/stringref" target="_blank">stringref extension</a> to CBOR, which provides significant additional reduction in encoded size.</p>
<p>Encoding type 8 indicates that the ABI can be found elsewhere, at the specified URI. This is typically the most compact of the supported forms, but also adds external dependencies for implementers. The specified URI may use any schema, but HTTP, IPFS, and Swarm are expected to be the most common.</p>
<h4 id="resolver-profile">Resolver profile</h4>
<p>A new resolver interface is defined, consisting of the following method:</p>
<pre><code>function ABI(bytes32 node, uint256 contentType) constant returns (uint256, bytes);
</code></pre><p>The interface ID of this interface is 0x2203ab56.</p>
<p>contentType is a bitfield, and is the bitwise OR of all the encoding types the caller will accept. Resolvers that implement this interface must return an ABI encoded using one of the requested formats, or <code>(0, &quot;&quot;)</code> if they do not have an ABI for this function, or do not support any of the requested formats.</p>
<p>The <code>abi</code> resolver profile is valid on both forward and reverse records.</p>
<h4 id="abi-lookup-process">ABI lookup process</h4>
<p>When attempting to fetch an ABI based on an ENS name, implementers should first attempt an ABI lookup on the name itself. If that lookup returns no results, they should attempt a reverse lookup on the Ethereum address the name resolves to.</p>
<p>Implementers should support as many of the ABI encoding formats as practical.</p>
<h3 id="rationale">Rationale</h3>
<p>Storing ABIs onchain avoids the need to introduce additional dependencies for applications wishing to fetch them, such as swarm or HTTP access. Given the typical compactness of ABIs, we believe this is a worthwhile tradeoff in many cases.</p>
<p>The two-step resolution process permits different names to provide different ABIs for the same contract, such as in the case where it&apos;s useful to provide a minimal ABI to some callers, as well as specifying ABIs for contracts that did not specify one of their own. The fallback to looking up an ABI on the reverse record permits contracts to specify their own canonical ABI, and prevents the need for duplication when multiple names reference the same contract without the need for different ABIs.</p>
<h3 id="copyright">Copyright</h3>
<p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank">CC0</a>.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="ensip-3-reverse-resolution.html" class="navigation navigation-prev " aria-label="Previous page: ENSIP-3: Reverse Resolution">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="ensip-5-text-records.html" class="navigation navigation-next " aria-label="Next page: ENSIP-5: Text Records">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"description":"A mechanism for storing ABI definitions in ENS, for easy lookup of contract interfaces by callers (formerly EIP-205).","title":"ENSIP-4: Support for contract ABIs","level":"1.9.4","depth":2,"next":{"title":"ENSIP-5: Text Records","level":"1.9.5","depth":2,"path":"ens-improvement-proposals/ensip-5-text-records.md","ref":"ens-improvement-proposals/ensip-5-text-records.md","articles":[]},"previous":{"title":"ENSIP-3: Reverse Resolution","level":"1.9.3","depth":2,"path":"ens-improvement-proposals/ensip-3-reverse-resolution.md","ref":"ens-improvement-proposals/ensip-3-reverse-resolution.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"ens-improvement-proposals/ensip-4-support-for-contract-abis.md","mtime":"2022-05-06T01:19:39.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-05-19T01:09:30.352Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

